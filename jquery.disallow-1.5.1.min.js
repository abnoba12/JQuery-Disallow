//The MIT License (MIT)

//Copyright (c) 2015 J.Hilburn, Jacob Weigand

//Permission is hereby granted, free of charge, to any person obtaining a copy
//of this software and associated documentation files (the "Software"), to deal
//in the Software without restriction, including without limitation the rights
//to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
//copies of the Software, and to permit persons to whom the Software is
//furnished to do so, subject to the following conditions:

//The above copyright notice and this permission notice shall be included in
//all copies or substantial portions of the Software.

//THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
//IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
//FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
//AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
//LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
//THE SOFTWARE.

//Written By: Jacob Weigand
//Last updated: 07-15-2015
//Version: 1.5.1
//Documentation: https://github.com/abnoba12/JQuery-Disallow/blob/master/README.md

!function(t){function a(a,e){var i=o(a);e.each(function(){var e=t(this),n=e.attr("data-disallow-from"),r=Array();if("undefined"!=typeof n&&n!==!1&&(r=n.split(","),-1!==t.inArray(i,r))){if(d(a,e),!s(e)&&(e.removeAttr("disabled"),e.show(),"OPTION"==e.prop("tagName")&&"true"==e.parent().attr("data-disallow-all-disabled"))){var l=e.parent().find("option:enabled");l.length>0&&(e.parent().removeAttr("data-disallow-all-disabled"),l.first().attr("selected",!0).trigger("click").trigger("change"))}e.trigger("change")}})}function e(a,e,d,o){e.each(function(){var e=t(this);switch(e.prop("tagName")){case"SELECT":i(e,o);break;case"OPTION":n(e);break;case"INPUT":r(e,o),e.trigger("input");break;default:console.error(e.prop("tagName")+" is unknown singleTarget type for the disallow library")}d&&e.hide(),l(a,e),e.trigger("change")})}function i(t,a){t.val("undefined"!=typeof a?a:""),t.attr("disabled","disabled")}function n(t){if(t.is(":selected")){t.attr("selected",!1).attr("disabled","disabled");var a=t.parent().find("option:enabled");0==a.length?t.parent().attr("data-disallow-all-disabled","true").val(""):a.first().attr("selected",!0).trigger("click").trigger("change")}else t.attr("disabled","disabled")}function r(t,a){switch(t.attr("type").toLowerCase()){case"checkbox":"undefined"!=typeof a?t.prop("checked",a):t.prop("checked",!1);break;case"text":t.val("undefined"!=typeof a?a:"")}t.attr("disabled",!0)}function l(a,e){var i=e.attr("data-disallow-from"),n=Array(),r=o(a);"undefined"!=typeof i&&i!==!1?(n=i.split(","),t.inArray(r,n)<0&&n.push(r)):n.push(r),e.attr("data-disallow-from",n.join(","))}function d(t,a){var e=a.attr("data-disallow-from"),i=Array(),n=o(t);"undefined"!=typeof e&&e!==!1&&(i=e.split(","),i=jQuery.grep(i,function(t){return t!==n}),e=i.join(","),""==e?a.removeAttr("data-disallow-from"):a.attr("data-disallow-from",e))}function o(t){var a=t.attr("name");return("undefined"==typeof a||0==a)&&(a=t.parent().attr("name")+"-"+t.attr("value")),a}function s(t){var a=t.attr("data-disallow-from");return"undefined"!=typeof a&&a!==!1&&""!=a?!0:!1}function u(a){return"undefined"!=typeof a&&null!==a&&"undefined"!=typeof a.condition&&null!==a.condition?condition=a.condition:"undefined"!==t(this).attr("data-disallow-condition")&&(condition=t(this).attr("data-disallow-condition")),condition}function f(a){return"undefined"!=typeof a&&null!==a&&"undefined"!=typeof a.target&&null!==a.target?target=t(a.target):"undefined"!==t(this).attr("data-disallow-target")&&(target=t(t(this).attr("data-disallow-target"))),target}function c(a){return hide="undefined"!=typeof a&&null!==a&&1==a.hide||"undefined"!=typeof t(this).attr("data-disallow-hide")&&null!==t(this).attr("data-disallow-hide")&&"true"==t(this).attr("data-disallow-hide")||("undefined"==typeof a.hide||null==a.hide)&&("undefined"==typeof t(this).attr("data-disallow-hide")||null==t(this).attr("data-disallow-hide"))?!0:!1,hide}function p(a){return"undefined"!=typeof a&&null!==a&&"undefined"!=typeof a.disallowedValue&&null!==a.disallowedValue?disallowedValue=a.disallowedValue:"undefined"!==t(this).attr("data-disallow-disallowedValue")&&(disallowedValue=t(this).attr("data-disallow-disallowedValue")),disallowedValue}t.fn.disallow=function(i){var n=this;return n.each(function(){var n=u(i),r=f(i),l=c(i),d=p(i),s=t(this),w=o(s);switch(s.prop("tagName")){case"OPTION":s.parent().on("change.disallow"+w,function(){s.is(n)?e(s,r,l,d):a(s,r)}).trigger("change");break;case"INPUT":switch(s.attr("type").toLowerCase()){case"checkbox":s.on("change.disallow",function(){s.is(n)?e(s,r,l,d):a(s,r)}).trigger("change");break;case"text":s.on("input.disallow",function(){s.is(n)?e(s,r,l,d):a(s,r)}).trigger("input");break;default:console.error(r.prop("tagName")+" is unknown target input type for the disallow library")}break;default:console.error(s.prop("tagName")+" is unknown source type for the disallow library")}}),0===t("form.data-disallow").length&&(t("form").addClass("data-disallow"),t("form.data-disallow").on("submit.disallow",function(){t("form.data-disallow [data-disallow-from][disabled]").removeAttr("disabled")})),this},t.fn.disallowUnbind=function(){this.each(function(){var a=t(this),e=o(a);switch(a.prop("tagName")){case"OPTION":a.parent().off("change.disallow"+e);break;case"INPUT":switch(a.attr("type").toLowerCase()){case"checkbox":a.off("change.disallow");break;case"text":a.off("input.disallow");break;default:console.error(a.prop("tagName")+" is unknown target type for the disallow library")}break;default:console.error(a.prop("tagName")+" is unknown type for the disallow library")}})},t.disallow={},t.disallow.manualDisallow=function(a){var i=t('<input type="text" name="'+a.disallowName+'"></input>'),n=c(a),r=p(a);e(i,t(a.target),n,r)},t.disallow.manualAllow=function(e){var i=t('<input type="text" name="'+e.disallowName+'"></input>');a(i,t(e.target))}}(jQuery);