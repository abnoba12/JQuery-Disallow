//The MIT License (MIT)

//Copyright (c) 2015 J.Hilburn, Jacob Weigand

//Permission is hereby granted, free of charge, to any person obtaining a copy
//of this software and associated documentation files (the "Software"), to deal
//in the Software without restriction, including without limitation the rights
//to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
//copies of the Software, and to permit persons to whom the Software is
//furnished to do so, subject to the following conditions:

//The above copyright notice and this permission notice shall be included in
//all copies or substantial portions of the Software.

//THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
//IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
//FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
//AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
//LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
//THE SOFTWARE.

//Written By: Jacob Weigand
//Last updated: 07-15-2015
//Version: 1.4
//Documentation: https://github.com/abnoba12/JQuery-Disallow/blob/master/README.md

!function(e){function t(t,a){var i=o(t);a.each(function(){var a=e(this),n=a.attr("data-disallow-from"),d=Array();if("undefined"!=typeof n&&n!==!1&&(d=n.split(","),-1!==e.inArray(i,d))){if(r(t,a),!s(a)){switch(a.removeAttr("disabled"),a.removeAttr("readonly"),a.off(".disallow-readonly"),a.show(),a.attr("type").toLowerCase()){case"checkbox":a.css("opacity","1")}if("OPTION"==a.prop("tagName")&&"true"==a.parent().attr("data-disallow-all-disabled")){var l=a.parent().find("option:enabled");l.length>0&&(a.parent().removeAttr("data-disallow-all-disabled"),l.first().attr("selected",!0).trigger("click").trigger("change"))}}a.trigger("change")}})}function a(t,a,r){a.each(function(){var a=e(this);switch(a.prop("tagName")){case"SELECT":i(a);break;case"OPTION":n(a);break;case"INPUT":d(a);break;default:console.error(a.prop("tagName")+" is unknown singleTarget type for the disallow library")}r&&a.hide(),l(t,a),a.trigger("change")})}function i(e){"undefined"!=typeof disallowedValue?(e.val(disallowedValue),e.attr("readonly","readonly"),e.on("mousedown.disallow-readonly",function(e){e.preventDefault()})):e.attr("disabled","disabled")}function n(e){if(e.is(":selected")){e.attr("selected",!1).attr("disabled","disabled");var t=e.parent().find("option:enabled");0==t.length?e.parent().attr("data-disallow-all-disabled","true").val(""):t.first().attr("selected",!0).trigger("click").trigger("change")}else e.attr("disabled","disabled")}function d(e){switch(e.attr("type").toLowerCase()){case"checkbox":"undefined"!=typeof disallowedValue?(e.prop("checked",disallowedValue),e.attr("readonly","readonly"),e.on("click.disallow-readonly",function(e){e.preventDefault()}).css("opacity","0.5")):(e.prop("checked",!1),e.attr("disabled",!0));break;case"text":"undefined"!=typeof disallowedValue?(e.val(disallowedValue),e.attr("readonly","readonly")):(e.val(""),e.attr("disabled",!0))}}function l(t,a){var i=a.attr("data-disallow-from"),n=Array(),d=o(t);"undefined"!=typeof i&&i!==!1?(n=i.split(","),e.inArray(d,n)<0&&n.push(d)):n.push(d),a.attr("data-disallow-from",n.join(","))}function r(e,t){var a=t.attr("data-disallow-from"),i=Array(),n=o(e);"undefined"!=typeof a&&a!==!1&&(i=a.split(","),i=jQuery.grep(i,function(e){return e!==n}),a=i.join(","),""==a?t.removeAttr("data-disallow-from"):t.attr("data-disallow-from",a))}function o(e){var t=e.attr("name");return("undefined"==typeof t||0==t)&&(t=e.parent().attr("name")+"-"+e.attr("value")),t}function s(e){var t=e.attr("data-disallow-from");return"undefined"!=typeof t&&t!==!1&&""!=t?!0:!1}function u(t){return"undefined"!=typeof t&&null!==t&&"undefined"!=typeof t.condition&&null!==t.condition?condition=t.condition:"undefined"!==e(this).attr("data-disallow-condition")&&(condition=e(this).attr("data-disallow-condition")),condition}function f(t){return"undefined"!=typeof t&&null!==t&&"undefined"!=typeof t.target&&null!==t.target?target=e(t.target):"undefined"!==e(this).attr("data-disallow-target")&&(target=e(e(this).attr("data-disallow-target"))),target}function c(t){return hide="undefined"!=typeof t&&null!==t&&1==t.hide||"undefined"!=typeof e(this).attr("data-disallow-hide")&&null!==e(this).attr("data-disallow-hide")&&"true"==e(this).attr("data-disallow-hide")||("undefined"==typeof t.hide||null==t.hide)&&("undefined"==typeof e(this).attr("data-disallow-hide")||null==e(this).attr("data-disallow-hide"))?!0:!1,hide}function p(t){return"undefined"!=typeof t&&null!==t&&"undefined"!=typeof t.disallowedValue&&null!==t.disallowedValue?disallowedValue=t.disallowedValue:"undefined"!==e(this).attr("data-disallow-disallowedValue")&&(disallowedValue=e(this).attr("data-disallow-disallowedValue")),disallowedValue}e.fn.disallow=function(i){return this.each(function(){var n=u(i),d=f(i),l=c(i),r=(p(i),e(this));switch(r.prop("tagName")){case"OPTION":r.parent().on("change",function(){r.is(n)?a(r,d,l):t(r,d)}).trigger("change");break;case"INPUT":switch(r.attr("type").toLowerCase()){case"checkbox":r.on("change",function(){r.is(n)?a(r,d,l):t(r,d)}).trigger("change");break;case"text":r.on("input",function(){r.is(n)?a(r,d,l):t(r,d)}).trigger("change");break;default:console.error(d.prop("tagName")+" is unknown target input type for the disallow library")}break;default:console.error(r.prop("tagName")+" is unknown source type for the disallow library")}}),this},e.disallow={},e.disallow.manualDisallow=function(t){var i=e('<input type="text" name="'+t.disallowName+'"></input>');t.hide="undefined"!=typeof t.hide?t.hide:!0,a(i,e(t.target),t.hide)},e.disallow.manualAllow=function(a){var i=e('<input type="text" name="'+a.disallowName+'"></input>');t(i,e(a.target))}}(jQuery);